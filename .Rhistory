gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("Crude oil price")
#| echo: true
#| code-fold: true
sp500_ts <- ts(sp500$Close, frequency = 365, start = c(year(min(sp500$Close))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("S&P500 index ")
#| echo: true
#| code-fold: true
btc_ts <- ts(btc$Close, frequency = 365, start = c(year(min(btc$Close))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("Bitcoin price")
#| echo: true
#| code-fold: true
btc_ts <- ts(btc$Close, frequency = 252, start = c(year(min(btc$Close))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("Bitcoin price")
# Example: create a spread (US 10Y - JP 10Y)
yields <- yields %>%
mutate(ex_spread = US10Y - JP10Y)
# Example: create a spread (US 10Y - JP 10Y)
yields <- spread %>%
mutate(ex_spread = US10Y - JP10Y)
View(spread)
# Example: create a spread (US 10Y - JP 10Y)
yields <- spread %>%
mutate(ex_spread = US_10Y - JP_10Y)
# Convert to time series (daily trading frequency ~252)
jp_spread_ts <- ts(yields$ex_spread, frequency = 252,
start = c(year(min(yields$Date))))
# --- Time Series Plot of Spread ---
ggplot(yields, aes(x = Date, y = jp_spread)) +
geom_line(color = "blue") +
labs(title = "US–Japan 10Y Yield Spread",
x = "Date", y = "Spread (US10Y – JP10Y)")
# Example: create a spread (US 10Y - JP 10Y)
yields <- spread %>%
mutate(ex_spread = US_10Y - JP_10Y)
# Convert to time series (daily trading frequency ~252)
jp_spread_ts <- ts(yields$ex_spread, frequency = 252,
start = c(year(min(yields$Date))))
# --- Time Series Plot of Spread ---
ggplot(yields, aes(x = Date, y = ex_spread)) +
geom_line(color = "blue") +
labs(title = "US–Japan 10Y Yield Spread",
x = "Date", y = "Spread (US10Y – JP10Y)")
# --- Lag Plot for Spread ---
gglagplot(jp_spread_ts, do.lines = FALSE) +
labs(title = "Lag Plots of US–Japan Yield Spread",
x = "Spread (t-k)", y = "Spread (t)")
#| echo: true
#| code-fold: true
jp_spread_ts <- ts(spread$JP_Spread, frequency = 252, start = c(year(min(spread$JP_Spread))))
gglagplot(jp_ts, do.lines = FALSE) +
labs(title = "Lag Plots of jp_spread",
x = "jp_spread (t-k)", y = "jp_spread (t)")
#| echo: true
#| code-fold: true
jp_spread_ts <- ts(spread$JP_Spread, frequency = 252, start = c(year(min(spread$JP_Spread))))
gglagplot(jp_ts, do.lines = FALSE) +
labs(title = "Lag Plots of japan_spread",
x = "jp_spread (t-k)", y = "jp_spread (t)")
#| echo: true
#| code-fold: true
jp_spread_ts <- ts(spread$JP_Spread, frequency = 252, start = c(year(min(spread$JP_Spread))))
gglagplot(jp_spread_ts, do.lines = FALSE) +
labs(title = "Lag Plots of japan_spread",
x = "jp_spread (t-k)", y = "jp_spread (t)")
#| echo: true
#| code-fold: true
eu_spread_ts <- ts(spread$EU_Spread, frequency = 252, start = c(year(min(spread$EU_Spread))))
gglagplot(eu_spread_ts, do.lines = FALSE) +
labs(title = "Lag Plots of euro_spread",
x = "eu_spread (t-k)", y = "lags")
#| echo: true
#| code-fold: true
sp500_ts <- ts(sp500$Close, frequency = 252, start = c(year(min(sp500$Close))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("S&P500 index ")
#| echo: true
#| code-fold: true
btc_ts <- ts(btc$Close, frequency = 252, start = c(year(min(btc$Close))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("Bitcoin price")
#| echo: true
#| code-fold: true
jp_plot <- plot_ly(aligned, x = ~Date, y = ~JP_Spread, type = 'scatter', mode = 'lines',
name = "Japan (10Y-2Y)") %>%
layout(title = "Japan Yield Curve Spread (10Y-2Y)",
xaxis = list(title = "Date"),
yaxis = list(title = "Spread (%)"))
#| echo: true
#| code-fold: true
uk_spread_ts <- ts(spread$UK_Spread, frequency = 252, start = c(year(min(spread$UK_Spread))))
gglagplot(uk_spread_ts, do.lines = FALSE) +
labs(title = "Lag Plots of UK_spread",
x = "Lags", y = "Uk spread %")
#| echo: true
#| code-fold: true
us_spread_ts <- ts(spread$US_Spread, frequency = 252, start = c(year(min(spread$US_Spread))))
gglagplot(us_spread_ts, do.lines = FALSE) +
labs(title = "Lag Plots of US_spread",
x = "Lags", y = "US spread %")
#| echo: true
#| code-fold: true
jp_ts <- ts(jp$USD_JP, frequency = 252, start = c(year(min(jp$USD_JP))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("JYP/USD")
#| echo: true
#| code-fold: true
decompose_jp_ts <- decompose(jp_ts)
#| echo: true
#| code-fold: true
decompose_jp_ts <- decompose(jp_ts)
autoplot(decompose_jp_ts)
#| echo: true
#| code-fold: true
decompose_uk_ts <- decompose(uk_ts)
autoplot(decompose_uk_ts)
#| echo: true
#| code-fold: true
decompose_eu_ts <- decompose(eu_ts)
autoplot(decompose_eu_ts)
#| echo: true
#| code-fold: true
decompose_oil_ts <- decompose(crude_oil_ts)
autoplot(decompose_oil_ts)
#| echo: true
#| code-fold: true
decompose_sp500_ts <- decompose(sp500_ts)
autoplot(decompose_sp500_ts)
#| echo: true
#| code-fold: true
decompose_btc_ts <- decompose(btc_ts)
autoplot(decompose_btc_ts)
#| echo: true
#| code-fold: true
decompose_jp_spread_ts <- decompose(jp_spread_ts)
autoplot(decompose_jp_spread_ts)
#| echo: true
#| code-fold: true
decompose_eu_spread_ts <- decompose(eu_spread_ts)
autoplot(decompose_eu_spread_ts)
#| echo: true
#| code-fold: true
decompose_uk_spread_ts <- decompose(uk_spread_ts)
autoplot(decompose_uk_spread_ts)
#| echo: true
#| code-fold: true
decompose_us_spread_ts <- decompose(us_spread_ts)
autoplot(decompose_us_spread_ts)
#| echo: true
#| code-fold: true
ggAcf(jp_ts) +
geom_segment(aes(xend = lag, yend = 0)) +
labs(title = "ACF of JPY currency rate") +
theme_bw()
ggPacf(jp_ts) +
geom_segment(aes(xend = lag, yend = 0)) +
labs(title = "PACF of JPY currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(jp_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of JPY currency rate") +
theme_bw()
ggPacf(jp_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of JPY currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(uk_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of GBP currency rate") +
theme_bw()
ggPacf(uk_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of GBP currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(eu_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of EUR currency rate") +
theme_bw()
ggPacf(eu_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of EUR currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(crude_oil_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Crude Oil Price") +
theme_bw()
ggPacf(crude_oil_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Crude Oil Price") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(sp500_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of S&P500 Index") +
theme_bw()
ggPacf(sp500_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of S&P500 Index") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(btc_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Bitcoin Price") +
theme_bw()
ggPacf(btc_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Bitcoin Price") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(jp_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Japan Spread Rate") +
theme_bw()
ggPacf(jp_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Japan Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(uk_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of UK Spread Rate") +
theme_bw()
ggPacf(uk_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of UK Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(us_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of US Spread Rate") +
theme_bw()
ggPacf(us_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of US Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(jp_ts) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of JPY currency rate") +
theme_bw()
ggPacf(jp_ts) +
geom_segment(aes(xend = lag, yend = 0), color="orange") +
labs(title = "PACF of JPY currency rate") +
theme_bw()
adf.test(jp_ts)
#| echo: true
#| code-fold: true
adf.test(crude_oil_ts)
#| echo: true
#| code-fold: true
adf.test(sp500_ts)
#| echo: true
#| code-fold: true
adf.test(btc_ts)
#| echo: true
#| code-fold: true
ggAcf(diff(log(jp_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of JPY currency rate") +
theme_bw()
ggPacf(diff(log(jp_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of JPY currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(diff(log(uk_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of GBP currency rate") +
theme_bw()
ggPacf(diff(log(uk_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of GBP currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(diff(log(eu_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of GBP currency rate") +
theme_bw()
ggPacf(diff(log(eu_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of GBP currency rate") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(diff(log(crude_oil))) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Crude Oil Price") +
theme_bw()
#| echo: true
#| code-fold: true
#| echo: true
#| code-fold: true
ggAcf(diff(log(crude_oil_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Crude Oil Price") +
theme_bw()
ggPacf(diff(log(crude_oil_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Crude Oil Price") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(log(jp_spread_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Japan Spread Rate") +
theme_bw()
ggPacf(diff(log(jp_spread_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Japan Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(jp_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Japan Spread Rate") +
theme_bw()
ggPacf(diff(log(jp_spread_ts))) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Japan Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(jp_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Japan Spread Rate") +
theme_bw()
ggPacf(diff((jp_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Japan Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(jp_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Japan Spread Rate") +
theme_bw()
ggPacf(diff(jp_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Japan Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(jp_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Euro Spread Rate") +
theme_bw()
ggPacf(eu_spread_ts) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Euro Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(eu_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of Euro Spread Rate") +
theme_bw()
ggPacf(diff(eu_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of Euro Spread Rate") +
theme_bw()
#| echo: true
#| code-fold: true
ggAcf(diff(us_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="blue") +
labs(title = "ACF of US Spread Rate") +
theme_bw()
ggPacf(diff(uk_spread_ts)) +
geom_segment(aes(xend = lag, yend = 0), color="red") +
labs(title = "PACF of US Spread Rate") +
theme_bw()
adf.test(diff(log(jp_ts)))
View(crude_oil)
colSums(is.na(crude_oil))
#| echo: true
#| code-fold: true
adf.test(diff(log(crude_oil_ts)))
colSums(is.na(crude_oil))
colSums(is.na(crude_oil_ts))
sum(is.na(crude_oil_ts))
#| echo: true
#| code-fold: true
crude_oil_ts <- ts(crude_oil$WTI, frequency = 365, start = c(year(min(crude_oil$WTI))))
gglagplot(jp_ts, do.lines=FALSE) +
xlab("Lags")+ylab("Crude oil price")
#| echo: true
#| code-fold: true
adf.test(diff(us_spread_ts))
#| echo: true
#| code-fold: true
adf.test(diff(uk_spread_ts))
#| echo: true
#| code-fold: true
adf.test(diff(log(btc_ts)))
#| echo: true
#| code-fold: true
adf.test(diff(log(sp500_ts)))
#| echo: true
#| code-fold: true
adf.test(diff(crude_oil_ts))
#| echo: true
#| code-fold: true
adf.test(diff(crude_oil_ts))
#| echo: true
#| code-fold: true
adf.test(diff(log(crude_oil_ts)))
#| echo: true
#| code-fold: true
jp_df <- data.frame(Date = time(jp_ts), Value = as.numeric(jp_ts))
jp_df$MA20 <- rollmean(jp_df$Value, 20, fill = NA, align = "right")
jp_df$MA50 <- rollmean(jp_df$Value, 50, fill = NA, align = "right")
jp_df$MA100 <- rollmean(jp_df$Value, 100, fill = NA, align = "right")
ggplot(jp_df, aes(x = Date)) +
geom_line(aes(y = Value), color = "black", alpha = 0.6) +
geom_line(aes(y = MA20), color = "blue", size = 0.8) +
geom_line(aes(y = MA50), color = "red", size = 0.8) +
geom_line(aes(y = MA100), color = "green", size = 0.8) +
labs(title = "JPY Currency Rate with Moving Averages",
x = "Date", y = "JPY rate") +
theme_bw()
#| echo: true
#| code-fold: true
library(zoo)
jp_df <- data.frame(Date = time(jp_ts), Value = as.numeric(jp_ts))
jp_df$MA20 <- rollmean(jp_df$Value, 20, fill = NA, align = "right")
jp_df$MA50 <- rollmean(jp_df$Value, 50, fill = NA, align = "right")
jp_df$MA100 <- rollmean(jp_df$Value, 100, fill = NA, align = "right")
ggplot(jp_df, aes(x = Date)) +
geom_line(aes(y = Value, color = "JPY Rate"), size = 0.6, alpha = 0.7) +
geom_line(aes(y = MA20, color = "MA20"), size = 0.8) +
geom_line(aes(y = MA50, color = "MA50"), size = 0.8) +
geom_line(aes(y = MA100, color = "MA100"), size = 0.8) +
labs(title = "JPY Currency Rate with Moving Averages",
x = "Date", y = "JPY rate", color = "Legend") +
scale_color_manual(values = c("JPY Rate"="black", "MA20"="blue", "MA50"="red", "MA100"="green")) +
theme_bw()
#| echo: true
#| code-fold: true
jp_df <- data.frame(Date = time(jp_ts), Value = as.numeric(jp_ts))
jp_df$MA20 <- rollmean(jp_df$Value, 20, fill = NA, align = "right")
jp_df$MA50 <- rollmean(jp_df$Value, 50, fill = NA, align = "right")
jp_df$MA100 <- rollmean(jp_df$Value, 100, fill = NA, align = "right")
plot_ly(jp_df, x = ~Date) %>%
add_lines(y = ~Value, name = "JPY Rate", line = list(color = "black")) %>%
add_lines(y = ~MA20, name = "MA20", line = list(color = "blue")) %>%
add_lines(y = ~MA50, name = "MA50", line = list(color = "red")) %>%
add_lines(y = ~MA100, name = "MA100", line = list(color = "green")) %>%
layout(title = "JPY Currency Rate with Moving Averages",
xaxis = list(title = "Date"),
yaxis = list(title = "JPY rate"))
#| echo: true
#| code-fold: true
us_spread_df <- data.frame(Date = time(us_spread_ts), Value = as.numeric(us_spread_ts))
us_spread_df$MA20 <- rollmean(us_spread_df$Value, 20, fill = NA, align = "right")
us_spread_df$MA50 <- rollmean(us_spread_df$Value, 50, fill = NA, align = "right")
us_spread_df$MA100 <- rollmean(us_spread_df$Value, 100, fill = NA, align = "right")
plot_ly(us_spread_df, x = ~Date) %>%
add_lines(y = ~Value, name = "US Spread", line = list(color = "black")) %>%
add_lines(y = ~MA20, name = "MA20", line = list(color = "blue")) %>%
add_lines(y = ~MA50, name = "MA50", line = list(color = "red")) %>%
add_lines(y = ~MA100, name = "MA100", line = list(color = "green")) %>%
layout(title = "US Spread with Moving Averages",
xaxis = list(title = "Date"),
yaxis = list(title = "Spread (bps)"))
#| echo: true
#| code-fold: true
us_spread_df <- data.frame(Date = time(us_spread_ts), Value = as.numeric(us_spread_ts))
us_spread_df$MA20 <- rollmean(us_spread_df$Value, 20, fill = NA, align = "right")
us_spread_df$MA50 <- rollmean(us_spread_df$Value, 50, fill = NA, align = "right")
us_spread_df$MA100 <- rollmean(us_spread_df$Value, 100, fill = NA, align = "right")
plot_ly(us_spread_df, x = ~Date) %>%
add_lines(y = ~Value, name = "US Spread", line = list(color = "black")) %>%
add_lines(y = ~MA20, name = "MA20", line = list(color = "blue")) %>%
add_lines(y = ~MA50, name = "MA50", line = list(color = "red")) %>%
add_lines(y = ~MA100, name = "MA100", line = list(color = "green")) %>%
layout(title = "US Spread with Moving Averages",
xaxis = list(title = "Date"),
yaxis = list(title = "Spread (bps)"))
